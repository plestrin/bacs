# This file define the following signature(s):
#	- aes128_v3 	: full aes128 encryption /decryption. WARNING: the effective address of the first round key is performed without an ADD (mostly used for encryption).
#					This is the only difference with the aes128_v2. No key binding for the last round: the offset might depend on the number of rounds.
#					Insert the byteswap in the signature otherwise there is too many false postive detection (1536 = 256 * 6)


# INPUT: 2 [4 frag, 44 frag]
# OUTPUT: 1 [4 frag]
# Remark: each of this subgraph occurrence counts for 1 in the subgraph isomorphism

"aes128_v3" (block_cipher)

1 (*) [I:1:1] -> 11 (SHR)
11 -> 1001 (XOR)
1 -> 12 (SHR)
12 -> 13 (AND)
13 -> 1001
1 -> 14 (SHL)
14 -> 15 (AND)
15 -> 1001
1 -> 16 (SHL)
16 -> 1001
2 (*) [I:1:2] -> 21 (SHR)
21 -> 1002 (XOR)
2 -> 22 (SHR)
22 -> 23 (AND)
23 -> 1002
2 -> 24 (SHL)
24 -> 25 (AND)
25 -> 1002
2 -> 26 (SHL)
26 -> 1002
3 (*) [I:1:3] -> 31 (SHR)
31 -> 1003 (XOR)
3 -> 32 (SHR)
32 -> 33 (AND)
33 -> 1003
3 -> 34 (SHL)
34 -> 35 (AND)
35 -> 1003
3 -> 36 (SHL)
36 -> 1003
4 (*) [I:1:4] -> 41 (SHR)
41 -> 1004 (XOR)
4 -> 42 (SHR)
42 -> 43 (AND)
43 -> 1004
4 -> 44 (SHL)
44 -> 45 (AND)
45 -> 1004
4 -> 46 (SHL)
46 -> 1004

5 (*) -> 202 (ADD)
5 -> 203 (ADD)
5 -> 204 (ADD)
5 -> 205 (ADD)
5 -> 206 (ADD)
5 -> 207 (ADD)
5 -> 208 (ADD)
5 -> 209 (ADD)
5 -> 210 (ADD)
5 -> 211 (ADD)
5 -> 212 (ADD)
5 -> 213 (ADD)
5 -> 214 (ADD)
5 -> 215 (ADD)
5 -> 216 (ADD)
5 -> 217 (ADD)
5 -> 218 (ADD)
5 -> 219 (ADD)
5 -> 220 (ADD)
5 -> 221 (ADD)
5 -> 222 (ADD)
5 -> 223 (ADD)
5 -> 224 (ADD)
5 -> 225 (ADD)
5 -> 226 (ADD)
5 -> 227 (ADD)
5 -> 228 (ADD)
5 -> 229 (ADD)
5 -> 230 (ADD)
5 -> 231 (ADD)
5 -> 232 (ADD)
5 -> 233 (ADD)
5 -> 234 (ADD)
5 -> 235 (ADD)
5 -> 236 (ADD)
5 -> 237 (ADD)
5 -> 238 (ADD)
5 -> 239 (ADD)
5 -> 240 (ADD)

5   -> (@) 301 (LOAD) [I:2:1]
202 -> (@) 302 (LOAD) [I:2:2]
203 -> (@) 303 (LOAD) [I:2:3]
204 -> (@) 304 (LOAD) [I:2:4]
205 -> (@) 305 (LOAD) [I:2:5]
206 -> (@) 306 (LOAD) [I:2:6]
207 -> (@) 307 (LOAD) [I:2:7]
208 -> (@) 308 (LOAD) [I:2:8]
209 -> (@) 309 (LOAD) [I:2:9]
210 -> (@) 310 (LOAD) [I:2:10]
211 -> (@) 311 (LOAD) [I:2:11]
212 -> (@) 312 (LOAD) [I:2:12]
213 -> (@) 313 (LOAD) [I:2:13]
214 -> (@) 314 (LOAD) [I:2:14]
215 -> (@) 315 (LOAD) [I:2:15]
216 -> (@) 316 (LOAD) [I:2:16]
217 -> (@) 317 (LOAD) [I:2:17]
218 -> (@) 318 (LOAD) [I:2:18]
219 -> (@) 319 (LOAD) [I:2:19]
220 -> (@) 320 (LOAD) [I:2:20]
221 -> (@) 321 (LOAD) [I:2:21]
222 -> (@) 322 (LOAD) [I:2:22]
223 -> (@) 323 (LOAD) [I:2:23]
224 -> (@) 324 (LOAD) [I:2:24]
225 -> (@) 325 (LOAD) [I:2:25]
226 -> (@) 326 (LOAD) [I:2:26]
227 -> (@) 327 (LOAD) [I:2:27]
228 -> (@) 328 (LOAD) [I:2:28]
229 -> (@) 329 (LOAD) [I:2:29]
230 -> (@) 330 (LOAD) [I:2:30]
231 -> (@) 331 (LOAD) [I:2:31]
232 -> (@) 332 (LOAD) [I:2:32]
233 -> (@) 333 (LOAD) [I:2:33]
234 -> (@) 334 (LOAD) [I:2:34]
235 -> (@) 335 (LOAD) [I:2:35]
236 -> (@) 336 (LOAD) [I:2:36]
237 -> (@) 337 (LOAD) [I:2:37]
238 -> (@) 338 (LOAD) [I:2:38]
239 -> (@) 339 (LOAD) [I:2:39]
240 -> (@) 340 (LOAD) [I:2:40]

301 -> 1001
302 -> 1002
303 -> 1003
304 -> 1004

1001 -> (I1F1) 1005 (aes_r9)
1002 -> (I1F2) 1005
1003 -> (I1F3) 1005
1004 -> (I1F4) 1005

305 -> (I2F1) 1005
306 -> (I2F2) 1005
307 -> (I2F3) 1005
308 -> (I2F4) 1005
309 -> (I2F5) 1005
310 -> (I2F6) 1005
311 -> (I2F7) 1005
312 -> (I2F8) 1005
313 -> (I2F9) 1005
314 -> (I2F10) 1005
315 -> (I2F11) 1005
316 -> (I2F12) 1005
317 -> (I2F13) 1005
318 -> (I2F14) 1005
319 -> (I2F15) 1005
320 -> (I2F16) 1005
321 -> (I2F17) 1005
322 -> (I2F18) 1005
323 -> (I2F19) 1005
324 -> (I2F20) 1005
325 -> (I2F21) 1005
326 -> (I2F22) 1005
327 -> (I2F23) 1005
328 -> (I2F24) 1005
329 -> (I2F25) 1005
330 -> (I2F26) 1005
331 -> (I2F27) 1005
332 -> (I2F28) 1005
333 -> (I2F29) 1005
334 -> (I2F30) 1005
335 -> (I2F31) 1005
336 -> (I2F32) 1005
337 -> (I2F33) 1005
338 -> (I2F34) 1005
339 -> (I2F35) 1005
340 -> (I2F36) 1005

1005 -> (O1F1) 1006 (XOR)
1005 -> (O1F2) 1007 (XOR)
1005 -> (O1F3) 1008 (XOR)
1005 -> (O1F4) 1009 (XOR)

1006 -> (I1F1) 1010 (aes_r1)
1007 -> (I1F2) 1010
1008 -> (I1F3) 1010
1009 -> (I1F4) 1010

341 (*) [I:2:41] -> (I2F1) 1010
342 (*) [I:2:42] -> (I2F2) 1010
343 (*) [I:2:43] -> (I2F3) 1010
344 (*) [I:2:44] -> (I2F4) 1010

1010 -> (O1F1) 1011 (XOR) [O:1:1]
1010 -> (O1F2) 1012 (XOR) [O:1:2]
1010 -> (O1F3) 1013 (XOR) [O:1:3]
1010 -> (O1F4) 1014 (XOR) [O:1:4]
